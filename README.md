# ğŸ§  Riddle Game (Full Stack Edition)

An interactive terminal-based riddle game built with Node.js, using **ES Modules**, **Object-Oriented Programming**, and a full **Express.js backend** with **Supabase** and **MongoDB**.

---

## ğŸ¯ Project Goal

Build a full-stack riddle game where:
- Players solve riddles in increasing difficulty
- Player data and riddle statistics are stored in databases
- Admins can manage riddles (CRUD)
- Leaderboards are dynamically generated by server logic

---

## ğŸ§± Architecture Overview

```
client/                   // Terminal-based game UI (readline-sync)
â”‚
â”œâ”€â”€ app.js               // Entry point (menu + actions)
â”œâ”€â”€ Riddle.js            // Riddle class logic
â”œâ”€â”€ Player.js            // Player logic & methods
â””â”€â”€ gameLogic.js         // All game/admin logic, modular in one file

server/                  // Express.js REST API
â”‚
â”œâ”€â”€ app.js               // Server setup and route mounting
â”œâ”€â”€ routes/              // Routers for /players and /riddles
â”œâ”€â”€ controllers/         // Request logic handlers
â”œâ”€â”€ dal/                 // Data access layers (Supabase & MongoDB)
â”œâ”€â”€ utils/               // Logger middleware
â””â”€â”€ lib/                 // DB clients: mongoClient.js, supabaseClient.js
```

---

## ğŸ› ï¸ Technologies Used

**Frontend (Terminal client):**
- Node.js
- readline-sync
- ES Modules
- OOP principles

**Backend (API server):**
- Express.js
- Supabase (for players)
- MongoDB Atlas (for riddles)
- RESTful routing

---

## ğŸ”¹ Game Flow (Client)

```mermaid
flowchart TD
    A[Start Game] --> B[Enter Name]
    B --> C[Check Player in Supabase]
    C --> D{New Player?}
    D -- Yes --> E[Create Player via API]
    D -- No --> F[Load Player]
    E --> G[Start Easy Riddles]
    F --> G
    G --> H[Load Riddles from Server by Difficulty]
    H --> I[Ask Riddle & Track Time]
    I --> J[Send Solve Time to Server]
    J --> K{More Riddles?}
    K -- Yes --> I
    K -- No --> L[Next Difficulty or Game Over]
    L --> M[Show Leaderboard]
```

---

## ğŸ‘¤ Main Classes

### `Riddle`

Represents a riddle object from the server.

- `id`, `taskDescription`, `difficulty`, `correctAnswer`, etc.
- `ask()` â€“ Interactively asks the user to solve it

### `Player`

Manages interaction with the server via API:

- `fromSupabaseRecord()` â€“ Initializes from server data
- `solveRiddle()` â€“ Sends solved riddle and time to backend

---

## âš™ï¸ REST API Endpoints

### ğŸ” Riddles

- `GET /riddles` â€“ Get all riddles  
- `GET /riddles/difficulty/:level` â€“ Get riddles by difficulty  
- `POST /riddles` â€“ Create a riddle  
- `PUT /riddles/:id` â€“ Update a riddle  
- `DELETE /riddles/:id` â€“ Delete a riddle  

### ğŸ§‘ Players

- `GET /players` â€“ Get all players  
- `GET /players/sorted-by-total` â€“ Leaderboard  
- `POST /players` â€“ Register new player  
- `PUT /players/:id` â€“ Update stats

---

## ğŸ“¦ How to Run

### Client (Terminal Game)

```bash
npm install readline-sync
node app.js
```

### Server (API)

```bash
cd server/
npm install
node app.js
```

Ensure your environment has:
- `SUPABASE_URL` + `SUPABASE_KEY`
- `MONGODB_URI`

---

## ğŸ§ª Features

- Interactive terminal-based gameplay
- Server-driven riddles by difficulty
- MongoDB riddle storage with CRUD
- Supabase player storage with tracking
- Leaderboard via backend route

---

âœï¸ Written by Nahman Ben Or  
ğŸ§‘â€ğŸ« Full Stack Track â€“ Yishai Malkieli
